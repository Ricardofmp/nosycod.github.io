---
title: Simple Locker from Not So Boring Malware 
classes: wide
header:
  teaser: /assets/images/MA/SimpleLocker/locker-android-malware.jfif
ribbon: MidnightBlue
categories:
  - Malware-analysis
toc: true
---

This is a sample gathered from [Not So Boring Malware](https://maldroid.github.io/android-malware-samples/).

# Surface Analysis

Let's start this analysis by opening the sample apk file on an Hex Editor.

<p align="center">
  <img src="\assets\images\MA\SimpleLocker\1.png" />
</p>
<center><font size="3"> <u>Figure</u>(1)<u></u> </font></center>
<br>

We can already identify some highly suspicious strings. 


We can also open the apk on the Jadx-gui to verify.

<p align="center">
  <img src="\assets\images\MA\SimpleLocker\2.png" />
</p>
<center><font size="3"> <u>Figure</u>(2)<u></u> </font></center>
<br>



# Static Analysis

By taking a quick look at the `AndroidManifest.xml` file, we can observe that the app only has 1 activity, 1 service and 1 receiver.
<p align="center">
  <img src="/assets/images/MA/SimpleLocker/3.png" />
</p>
<center><font size="3"> <u>Figure</u>(3) AndroidManifest.xml file<u></u> </font></center>
<br>

The activity `MainActivity` starts the service, `MyService`, as it is created.

The receiver,`BootReceiver`, listens to 2 kinds of actions, `BOOT_COMPLETED` and `QUICKBOOT_POWERON`. This is a form of persistence, as the malware will restart every time the device reboots (or cold boots).
On the `OnReceive` method of this receiver, it also sends an intent to start `MyService`.

This indicates that the main behavior of this app is done on the service, `MyService`. 


# Locking Functionality


<p align="center">
  <img src="/assets/images/MA/SimpleLocker/4.png" />
</p>
<center><font size="3"> <u>Figure</u>(4) Screen on the emulator after launching the app<u></u> </font></center>
<br>
This is the layout presented to the user when it launches the app by clicking on the icon or by rebooting the phone. The user is prevented from clicking away from this interface, or performing any other task on the device.
This is done on `MyService` by inflating this layout (main.xml) to a view with the layout parameters defined here:
`new WindowManager.LayoutParams(-2, -2, 2002, 1, -3);`
The `2002` value refers to the window type: TYPE_PHONE. According to the [documentation] (https://developer.android.com/reference/android/view/WindowManager.LayoutParams#TYPE_PHONE), these windows are placed above all applications, but behind the status bar.
<br>This application falls under the category of ransomware, as it demands a ransom to "unlock" the device.
However, if we analyze the code triggered when the button is clicked, we can state some interesting facts:

<p align="center">
  <img src="/assets/images/MA/SimpleLocker/5.png" />
</p>
<center><font size="3"> <u>Figure</u>(5) "Unlocking" code<u></u> </font></center>
<br>

1 - If the user inserts the supposed "key" (`Abdullah@`) to unlock the device, the service will be started once again.

2 - If the user inserts an "incorret key", nothing changes.


# Conclusion

In summary, there's no real unlocking of the device, unless the user uninstalls the app through adb or it just stops working, as it happened during the dynamic analysis on the emulator.
This sample was a really simple one, being the first one from the Easy Samples section on [Not So Boring Malware](https://maldroid.github.io/android-malware-samples/).

# IoCs

APK SHA256 hash: `5251a356421340a45c8dc6d431ef8a8cbca4078a0305a87f4fbd552e9fc0793e`

