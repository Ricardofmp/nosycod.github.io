---
title: Simple Locker from Not So Boring Malware 
classes: wide
header:
  teaser: /assets/images/MA/hydra/locker-android-malware.jpg
ribbon: MidnightBlue
categories:
  - Malware-analysis
toc: true
---

This is a sample gathered on [Not So Boring Malware](https://maldroid.github.io/android-malware-samples/).

# Surface Analysis

Let's start by using an Hex Editor on the .apk file.

<p align="center">
  <img src="\assets\images\MA\SimpleLocker\1.png" />
</p>
<center><font size="3"> <u>Figure</u>(1)<u></u> </font></center>
<br>

We can already see some really suspicious strings. 


Let's open the apk on the Jadx-gui now, and check the strings 

<p align="center">
  <img src="\assets\images\MA\SimpleLocker\2.png" />
</p>
<center><font size="3"> <u>Figure</u>(2)<u></u> </font></center>
<br>



# Static Analysis

By taking a quick look at the `AndroidManifest.xml` file, we can observe that the app only has one activity, one service, one receiver.
<p align="center">
  <img src="/assets/images/MA/SimpleLocker/3.png" />
</p>
<center><font size="3"> <u>Figure</u>(3) AndroidManifest.xml file<u></u> </font></center>
<br>

The activity starts “MyService” as it is created.

BootReceiver listens to 2 kinds of actions, BOOT_COMPLETED and QUICKBOOT_POWERON. This is a form of persistence. 
On the OnReceive method of this receiver, it also sends an intent to start MyService.

This indicates that the main behavior of this app is done on the Service.


## Locking the Screen


<p align="center">
  <img src="/assets/images/MA/SimpleLocker/4.png" />
</p>
<center><font size="3"> <u>Figure</u>(4) Screen on the emulator after launching the app<u></u> </font></center>
<br>
This is the layout presented to the user when it launches the app by clicking on the icon or by rebooting the phone.
This is done on MyService by inflating this layout.
This application fits the cathegory of Ransomware, as it is asking for a ransom in order to unlock the device.

However, if we analyze the code triggered when the button is clicked, we can state some interesting facts:

<p align="center">
  <img src="/assets/images/MA/SimpleLocker/5.png" />
</p>
<center><font size="3"> <u>Figure</u>(5) "Unlocking" code<u></u> </font></center>
<br>

1 - If the user inserts the supposed "key" to unlock the device, it restarts the service.
2 - If we insert an "incorret key", nothing changes.



# Conclusion

In summary, there's no real unlocking of the device, unless the user uninstalls the app or it stops working, as it happened during the dynamic analysis on the emulator.


# IoCs


APK hash: `5251a356421340a45c8dc6d431ef8a8cbca4078a0305a87f4fbd552e9fc0793e`

